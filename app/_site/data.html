<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Aidan Neeson - CMPSC 610 Artifact - A Look at the Data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Aidan Neeson - CMPSC 610 Artifact</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./data.html" aria-current="page"> 
<span class="menu-text">Data</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./rf.html"> 
<span class="menu-text">Random Forest</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./svm.html"> 
<span class="menu-text">SVM</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./ann.html"> 
<span class="menu-text">ANN</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#approaches" id="toc-approaches" class="nav-link active" data-scroll-target="#approaches">Approaches</a>
  <ul class="collapse">
  <li><a href="#the-old-data" id="toc-the-old-data" class="nav-link" data-scroll-target="#the-old-data">The Old Data</a>
  <ul class="collapse">
  <li><a href="#structure-and-make-up" id="toc-structure-and-make-up" class="nav-link" data-scroll-target="#structure-and-make-up">Structure and Make-up</a></li>
  <li><a href="#clustering" id="toc-clustering" class="nav-link" data-scroll-target="#clustering">Clustering</a></li>
  </ul></li>
  <li><a href="#the-new-data" id="toc-the-new-data" class="nav-link" data-scroll-target="#the-new-data">The New Data</a>
  <ul class="collapse">
  <li><a href="#wind" id="toc-wind" class="nav-link" data-scroll-target="#wind">Wind</a></li>
  <li><a href="#solar" id="toc-solar" class="nav-link" data-scroll-target="#solar">Solar</a></li>
  </ul></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-notebooks"><h2>Notebooks</h2><ul><li><a href="1-datasets-preview.html"><i class="bi bi-journal-code"></i>Data Preview</a></li><li><a href="5-rf-old-preview.html"><i class="bi bi-journal-code"></i>Old Random Forest Model</a></li><li><a href="6-data-clustering-preview.html"><i class="bi bi-journal-code"></i>Data Clustering</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">A Look at the Data</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="approaches" class="level1">
<h1>Approaches</h1>
<p>Data are a crucial piece of this research project. As such, much of the effort and consideration went into selecting, crafting, and refactoring the datasets to suit the need as best as possible. Throughout this process, many things were tried and tossed away. These include the form of the data, and even methods for processing the data to make it easier for certain machine learning models to use them. In the end, an effective appraoch was discovered. Each of these snapshots will be covered below.</p>
<section id="the-old-data" class="level2">
<h2 class="anchored" data-anchor-id="the-old-data">The Old Data</h2>
<p>Both the <a href="https://data.nrel.gov/submissions/54">wind</a> and <a href="https://nsrdb.nrel.gov/">solar</a> data used in this project orginally come from The National Renewable Energy Laboratory (NREL). The data comes with many attributes that are crucial to the analysis this project seeks to conduct, however, there are still pieces missing to truly acheive the full picture. Regardless, compared to other publically available datasets, these were the best suited for the job, and offered a good starting point.</p>
<section id="structure-and-make-up" class="level3">
<h3 class="anchored" data-anchor-id="structure-and-make-up">Structure and Make-up</h3>
<p>The original datasets came with some basic attributes:</p>
<ul>
<li>longitude</li>
<li>latitude</li>
<li>wind speed</li>
<li>solar irradiance</li>
<li>capacity</li>
<li>capacity factor</li>
</ul>
<p>This, at first, is not enough data to begin predicting for energy generation and cost. For this, actual data on energy generation and cost is needed. With what was provided, these could be calculated. To start, a few simple calculations were used to find the energy and cost values desired. The attribute <code>capacity</code> denotes how much energy a certain technology can produce under ideal conditions. <code>Capacity factor</code> denotes what fraction of the technologyâ€™s <code>capacity</code> is produced. With this, a simple estimate for energy generation can be calculated by multiplying both values together. For cost, many estimates exist that outline how much a technology costs per watt of installed capacity. Using these estimates, and multiplying by capacity, a value for cost can be aquired. This produced two datasets that took this shape:</p>
<section id="old-wind-data" class="level4">
<h4 class="anchored" data-anchor-id="old-wind-data">Old Wind Data</h4>
<div class="quarto-embed-nb-cell">
<div id="cell-wind-old-dataset-preview" class="cell" data-execution_count="4">
<div id="wind-old-dataset-preview" class="cell-output cell-output-display" data-execution_count="4">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">lat</th>
<th data-quarto-table-cell-role="th">long</th>
<th data-quarto-table-cell-role="th">wind_speed</th>
<th data-quarto-table-cell-role="th">farm_type</th>
<th data-quarto-table-cell-role="th">capacity</th>
<th data-quarto-table-cell-role="th">capacity_factor</th>
<th data-quarto-table-cell-role="th">power_generation</th>
<th data-quarto-table-cell-role="th">estimated_cost</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
<td>23.510410</td>
<td>-117.147260</td>
<td>6.07</td>
<td>offshore</td>
<td>16</td>
<td>0.169</td>
<td>23687.04</td>
<td>20800000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>24.007446</td>
<td>-93.946777</td>
<td>7.43</td>
<td>offshore</td>
<td>16</td>
<td>0.302</td>
<td>42328.32</td>
<td>20800000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2</td>
<td>25.069138</td>
<td>-97.482483</td>
<td>8.19</td>
<td>offshore</td>
<td>16</td>
<td>0.375</td>
<td>52560.00</td>
<td>20800000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>3</td>
<td>25.069443</td>
<td>-97.463135</td>
<td>8.19</td>
<td>offshore</td>
<td>16</td>
<td>0.375</td>
<td>52560.00</td>
<td>20800000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>4</td>
<td>25.069763</td>
<td>-97.443756</td>
<td>8.19</td>
<td>offshore</td>
<td>16</td>
<td>0.376</td>
<td>52700.16</td>
<td>20800000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<a class="quarto-notebook-link" id="nblink-1" href="1-datasets-preview.html#cell-wind-old-dataset-preview">Source: Data Preview</a></div>
</section>
<section id="old-solar-data" class="level4">
<h4 class="anchored" data-anchor-id="old-solar-data">Old Solar Data</h4>
<div class="quarto-embed-nb-cell">
<div id="cell-solar-old-dataset-preview" class="cell" data-execution_count="5">
<div id="solar-old-dataset-preview" class="cell-output cell-output-display" data-execution_count="5">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">lat</th>
<th data-quarto-table-cell-role="th">long</th>
<th data-quarto-table-cell-role="th">irradiance</th>
<th data-quarto-table-cell-role="th">farm_type</th>
<th data-quarto-table-cell-role="th">capacity</th>
<th data-quarto-table-cell-role="th">capacity_factor</th>
<th data-quarto-table-cell-role="th">power_generation</th>
<th data-quarto-table-cell-role="th">estimated_cost</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
<td>25.896492</td>
<td>-97.460358</td>
<td>5.634079</td>
<td>large_community</td>
<td>5.00</td>
<td>0.235</td>
<td>10282.193270</td>
<td>13300000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>26.032654</td>
<td>-97.738098</td>
<td>5.616413</td>
<td>small_utility</td>
<td>5.00</td>
<td>0.234</td>
<td>10249.953070</td>
<td>13300000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2</td>
<td>26.059063</td>
<td>-97.208252</td>
<td>5.746738</td>
<td>small_community</td>
<td>0.15</td>
<td>0.239</td>
<td>314.633929</td>
<td>399000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>3</td>
<td>26.078449</td>
<td>-98.073364</td>
<td>5.742196</td>
<td>small_utility</td>
<td>5.00</td>
<td>0.239</td>
<td>10479.506980</td>
<td>13300000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>4</td>
<td>26.143227</td>
<td>-98.311340</td>
<td>5.817187</td>
<td>small_utility</td>
<td>5.00</td>
<td>0.242</td>
<td>10616.365970</td>
<td>13300000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<a class="quarto-notebook-link" id="nblink-2" href="1-datasets-preview.html#cell-solar-old-dataset-preview">Source: Data Preview</a></div>
<p>The rough and simplistic nature of these estimates are generally okay as the concern of this project is to determine how well machine learning algorithms predict values, and not the correctness and integrity of the values themselves. Nonetheless, issues still appeared because of this. When training and testing the Random Forest Regressor, a feature importance graph was used to determine which attributes are the most important. This can also give insights into how the variables are used by other models as well. When running on the old wind data, the graph indicated one variable was dominating the dataset.</p>
<div class="quarto-embed-nb-cell">
<div id="cell-fig-feature-importances-old-wind" class="cell" data-execution_count="3">
<div class="cell-output cell-output-display">
<div id="fig-feature-importances-old-wind" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-feature-importances-old-wind-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="data_files/figure-html/5-rf-old-fig-feature-importances-old-wind-output-1.png" id="fig-feature-importances-old-wind" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-feature-importances-old-wind-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1
</figcaption>
</figure>
</div>
</div>
</div>
<a class="quarto-notebook-link" id="nblink-3" href="5-rf-old-preview.html#cell-fig-feature-importances-old-wind">Source: Old Random Forest Model</a></div>
<div class="quarto-embed-nb-cell">
<div id="feature-importances-old-wind" class="cell" data-execution_count="2">
<div class="cell-output cell-output-stdout">
<pre><code>Feature Importances
----------------------------
lat: 1.7415146179729832e-09
long: 4.556724073707158e-09
wind_speed: 2.5874951940190983e-08
capacity_factor: 0.0005676720796435423
capacity: 99.99943229574717</code></pre>
</div>
</div>
<a class="quarto-notebook-link" id="nblink-4" href="5-rf-old-preview.html#cell-feature-importances-old-wind">Source: Old Random Forest Model</a></div>
<p>Out of all of the features, <code>capacity</code> was shown to have the highest importance. This makes sense as both calculations are made up of direct proportions that scale based on <code>capacity</code>. This then indicates that the issue is not Random Forest exclusive, as this bias is present in the dataset, and not in how the algorithm interprets the dataset. Changes had to be implemeneted to remove this bias, which included adding more features and using more in-depth calculations to derive the features to be predicted. These are covered in <a href="#the-new-data">The New Data</a>.</p>
</section>
</section>
<section id="clustering" class="level3">
<h3 class="anchored" data-anchor-id="clustering">Clustering</h3>
<p>The initial direction of this project was to look specifically into clustering techniques and cluster analysis. This process consists of grouping similar data into a specified number of clusters. When considering the geospatial data used for this project, clustering would be used to abstract coordinates in the form of longitude and latitude into a single value, a cluster ID. The cluster IDâ€™s would then represent the other features of the data point, allowing for predictions of other features to be made based off of a given cluster ID or coordinate location. The main two steps for performing the clustering is breifly outlined below:</p>
<ol type="1">
<li>Determine the number of optimal clusters for the dataset.</li>
</ol>
<p>To do this, you just need to cluster the data with varying cluster numbers, score them, and graph the scores by the number of clusters and determine the point at which gains start to diminish.</p>
<div class="quarto-embed-nb-cell">
<div id="cell-fig-optimal-clusters" class="cell" data-execution_count="4">
<div class="cell-output cell-output-display">
<div id="fig-optimal-clusters" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-optimal-clusters-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="data_files/figure-html/6-data-clustering-fig-optimal-clusters-output-1.png" id="fig-optimal-clusters" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-optimal-clusters-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2
</figcaption>
</figure>
</div>
</div>
</div>
<a class="quarto-notebook-link" id="nblink-5" href="6-data-clustering-preview.html#cell-fig-optimal-clusters">Source: Data Clustering</a></div>
<ol start="2" type="1">
<li>Cluster the data and plot the results</li>
</ol>
<p>With the optimal number of clusters (or any desired number), the data can be clustered, with each data point given a cluster ID.</p>
<div class="quarto-embed-nb-cell">
<div id="cell-clustered-data-preview" class="cell" data-execution_count="6">
<div id="clustered-data-preview" class="cell-output cell-output-display" data-execution_count="6">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">lat</th>
<th data-quarto-table-cell-role="th">long</th>
<th data-quarto-table-cell-role="th">cluster_label</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>23.510410</td>
<td>-117.147260</td>
<td>7</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>24.007446</td>
<td>-93.946777</td>
<td>6</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>25.069138</td>
<td>-97.482483</td>
<td>6</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>25.069443</td>
<td>-97.463135</td>
<td>6</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>25.069763</td>
<td>-97.443756</td>
<td>6</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<a class="quarto-notebook-link" id="nblink-6" href="6-data-clustering-preview.html#cell-clustered-data-preview">Source: Data Clustering</a></div>
<p>Now that clusters are generated, they can be plotted and visualized.</p>
<div class="quarto-embed-nb-cell">
<div id="cell-fig-clustered-data" class="cell" data-execution_count="7">
<div class="cell-output cell-output-display">
<div id="fig-clustered-data" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-clustered-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="data_files/figure-html/6-data-clustering-fig-clustered-data-output-1.png" id="fig-clustered-data" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-clustered-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3
</figcaption>
</figure>
</div>
</div>
</div>
<a class="quarto-notebook-link" id="nblink-7" href="6-data-clustering-preview.html#cell-fig-clustered-data">Source: Data Clustering</a></div>
<p>This not only shows the shape and dimensions of the data, but it also gives insights into how many clusters are suitable for the task. The scale of the data makes the number of optimal clusters here a bit ambiguous. Although around 20 seems to be the best, 20 clusters does not seem to represent the nuances of how geospatial data like wind speed and solar raditation changes throughout the country. This seems to indicate that this approach is a bit unreliable in that regard and could introduce more bias into the data and models.</p>
<p>Additionally, the clustering could also help increase the performance of the algorithms by lowering the number of input parameters. Simplifying the inputs allows the models to interpret the data easier, leading to better predictions. The issues described in <a href="#structure-and-make-up">the structure and make-up section</a> further examplified this potential benefit. But for those same reasons, clustering ended up not being an ideal pathway forward. Not only would refactoring the data to remove the bias negate the benefits of clustering in the long run, but clustering also ends up become computationally expensive and tedious to implement and analyze given the nature of the data. For these reasons it was discarded as an aspect of the project.</p>
</section>
</section>
<section id="the-new-data" class="level2">
<h2 class="anchored" data-anchor-id="the-new-data">The New Data</h2>
<p>To overcome the issues outlined above, the datasets were both refactored heavily to remove the bias present. This fixed structural issues, but also allowed for in-depth analysis of mahcine learning models without the time and efficiency overheads that would be present if clustering remained a crucial piece of the project. The process and results of refactoring both of the datasets are outlined below:</p>
<section id="wind" class="level3">
<h3 class="anchored" data-anchor-id="wind">Wind</h3>
<p>To reduce the bias in the wind dataset, new features were added and a new equation was used that incorporated more features than just <code>capacity</code> to ensure a wider range of importance across the board. Two new features were added:</p>
<ol type="1">
<li>State - the state that the latitude and longitude coordinates are within.</li>
<li>Levelized Cost of Energy (LCOE) - the average net cost of electricity generation for a generator over its lifetime.</li>
</ol>
<p>Both of these features gave way for more inclusive calculations to be used for both energy generation and cost. The updated method to find the energy generation, <span class="math inline">\(J\)</span>, for a given wind farm uses the following equation where <span class="math inline">\(c\)</span> is <code>capacity</code>, <span class="math inline">\(\rho\)</span> is the density of air, <span class="math inline">\(A\)</span> is the swept area of the wind turbine, <span class="math inline">\(v\)</span> is the <code>wind speed</code>, <span class="math inline">\(h\)</span> is the number of hours in a year, and <span class="math inline">\(c_f\)</span> is <code>capacity factor</code>:</p>
<blockquote class="blockquote">
<p><span class="math inline">\(J = \frac{c}{2}\left( \frac{1}{2}\rho Av^3\right)h c_f\)</span></p>
<p>Some values here are assumed constants: <span class="math inline">\(\rho = 1.225 kg/m^3\)</span>, <span class="math inline">\(A = 7854 m^2\)</span>, <span class="math inline">\(h = 8760hrs\)</span></p>
</blockquote>
<p>Also, this equation was split at certain parts to increase the number of features, to aide the model in being able to track the relationships better. The splits added the features <code>available_wind_power</code> and <code>available_energy</code>.</p>
<p>Calculating the cost using LCOE is very simple. A technologyâ€™s LCOE is measured in dollars per watt-hour of energy generated. The only other piece needed is the lifespan of the technology. For this project, a 20 year lifespan is assumed for all wind turbines. This results in this equation where <span class="math inline">\(J\)</span> is generated energy, <span class="math inline">\(l\)</span> is the LCOE of the technology in the state, and <span class="math inline">\(t\)</span> is the lifespan of the technology:</p>
<blockquote class="blockquote">
<p><span class="math inline">\(C = Jlt\)</span></p>
</blockquote>
<p>These equations incorporate crucial pieces of geospatial data that were not present in the previous calculation. It also adds other assumed constants, which add complexity to the calculation and obscure the relationships a bit, giving the model more agency to work out the connections. In the end, it results in a dataset that looks like this:</p>
<div class="quarto-embed-nb-cell">
<div id="cell-wind-dataset-preview" class="cell" data-execution_count="6">
<div id="wind-dataset-preview" class="cell-output cell-output-display" data-execution_count="6">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">lat</th>
<th data-quarto-table-cell-role="th">long</th>
<th data-quarto-table-cell-role="th">state</th>
<th data-quarto-table-cell-role="th">farm_type</th>
<th data-quarto-table-cell-role="th">wind_speed</th>
<th data-quarto-table-cell-role="th">lcoe</th>
<th data-quarto-table-cell-role="th">capacity</th>
<th data-quarto-table-cell-role="th">capacity_factor</th>
<th data-quarto-table-cell-role="th">available_wind_power</th>
<th data-quarto-table-cell-role="th">available_energy</th>
<th data-quarto-table-cell-role="th">generated_energy</th>
<th data-quarto-table-cell-role="th">cost</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
<td>25.896492</td>
<td>-97.460358</td>
<td>Texas</td>
<td>onshore</td>
<td>7.46</td>
<td>31</td>
<td>2</td>
<td>0.433</td>
<td>1.997163</td>
<td>17495.14630</td>
<td>7575.398348</td>
<td>4.696747e+06</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>26.032654</td>
<td>-97.738098</td>
<td>Texas</td>
<td>onshore</td>
<td>7.45</td>
<td>31</td>
<td>10</td>
<td>0.414</td>
<td>9.945710</td>
<td>87124.42376</td>
<td>36069.511440</td>
<td>2.236310e+07</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2</td>
<td>26.059063</td>
<td>-97.208252</td>
<td>Texas</td>
<td>onshore</td>
<td>8.18</td>
<td>31</td>
<td>2</td>
<td>0.506</td>
<td>2.633037</td>
<td>23065.40088</td>
<td>11671.092850</td>
<td>7.236078e+06</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>3</td>
<td>26.078449</td>
<td>-98.073364</td>
<td>Texas</td>
<td>onshore</td>
<td>7.17</td>
<td>31</td>
<td>16</td>
<td>0.363</td>
<td>14.185493</td>
<td>124264.92160</td>
<td>45108.166540</td>
<td>2.796706e+07</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>4</td>
<td>26.143227</td>
<td>-98.311340</td>
<td>Texas</td>
<td>onshore</td>
<td>7.06</td>
<td>31</td>
<td>16</td>
<td>0.358</td>
<td>13.542570</td>
<td>118632.91080</td>
<td>42470.582050</td>
<td>2.633176e+07</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<a class="quarto-notebook-link" id="nblink-8" href="1-datasets-preview.html#cell-wind-dataset-preview">Source: Data Preview</a></div>
<p>This dataset can be accessed and downloaded from <a href="https://drive.google.com/file/d/1DfA-SBMgd4lOy1eMd10OHLN7Poe5PR2F/view?usp=sharing">here</a>.</p>
</section>
<section id="solar" class="level3">
<h3 class="anchored" data-anchor-id="solar">Solar</h3>
<p>Similar to the wind dataset, bias was reduced by adding more features and using a new equation which incorporated more features. Like the wind data, to make these adjustments, <code>state</code> and <code>lcoe</code> needed to be added as features. On top of these, two other features were dervied as part of the calculation to determine the generated energy. These are as follows:</p>
<ol type="1">
<li>Array Area, where <span class="math inline">\(c\)</span> is <code>capacity</code>, <span class="math inline">\(I\)</span> is the <code>solar irradiance</code> and <span class="math inline">\(c_f\)</span> is the <code>capacity factor</code>.</li>
</ol>
<blockquote class="blockquote">
<p><span class="math inline">\(A = \frac{24c}{Ic_f}\)</span></p>
<p>We multiply by 24 because <span class="math inline">\(I\)</span> is in units of <span class="math inline">\(kWh/m^2/day\)</span> and we want it in units of <span class="math inline">\(kWh/m^2\)</span> to ensure we end up with an area as the result.</p>
</blockquote>
<ol start="2" type="1">
<li>Available Solar Resource, where <span class="math inline">\(I\)</span> is the <code>solar irradiance</code> and <span class="math inline">\(A\)</span> is the <code>array area</code>.</li>
</ol>
<blockquote class="blockquote">
<p><span class="math inline">\(P = \frac{IA}{24*1000}\)</span></p>
<p>The 24 serves the same purpose as before, but the 1000 here changes the units from <span class="math inline">\(kWh\)</span> to <span class="math inline">\(MWh\)</span> to stay consistent all results.</p>
</blockquote>
<p>With these, an equation for generated energy, <span class="math inline">\(J\)</span> can be derived, where <span class="math inline">\(P\)</span> is the <code>available solar resource</code>, <span class="math inline">\(h\)</span> is the number of hours in a year, <span class="math inline">\(c_f\)</span> is the <code>capacity factor</code>, and <span class="math inline">\(q\)</span> is the system losses, which is assumed to be 14%:</p>
<blockquote class="blockquote">
<p><span class="math inline">\(J = P h  c_f  q\)</span></p>
</blockquote>
<p>Same as the wind data, calculating the cost using the LCOE is very simple. A lifespan of 20 years is used again for consistency:</p>
<blockquote class="blockquote">
<p><span class="math inline">\(C = Jlt\)</span></p>
</blockquote>
<p>The chain of calculations incorporate more of the geospatial data, which exemplifies the purpose of the research project much more than what the old data had, even with clustering. Again, it allows the model to do its best at finding the relationship, compared to just recognizing a direct proportion like before. The resulting solar dataset looks like this:</p>
<div class="quarto-embed-nb-cell">
<div id="cell-solar-dataset-preview" class="cell" data-execution_count="7">
<div id="solar-dataset-preview" class="cell-output cell-output-display" data-execution_count="7">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">lat</th>
<th data-quarto-table-cell-role="th">long</th>
<th data-quarto-table-cell-role="th">state</th>
<th data-quarto-table-cell-role="th">farm_type</th>
<th data-quarto-table-cell-role="th">irradiance</th>
<th data-quarto-table-cell-role="th">lcoe</th>
<th data-quarto-table-cell-role="th">capacity</th>
<th data-quarto-table-cell-role="th">capacity_factor</th>
<th data-quarto-table-cell-role="th">array_area</th>
<th data-quarto-table-cell-role="th">available_solar_resource</th>
<th data-quarto-table-cell-role="th">generated_energy</th>
<th data-quarto-table-cell-role="th">cost</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
<td>25.896492</td>
<td>-97.460358</td>
<td>Texas</td>
<td>large_community</td>
<td>5.634079</td>
<td>39</td>
<td>5.00</td>
<td>0.235</td>
<td>90633.862770</td>
<td>21.276596</td>
<td>6132.00</td>
<td>4782960.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>26.032654</td>
<td>-97.738098</td>
<td>Texas</td>
<td>small_utility</td>
<td>5.616413</td>
<td>39</td>
<td>5.00</td>
<td>0.234</td>
<td>91307.484990</td>
<td>21.367521</td>
<td>6132.00</td>
<td>4782960.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2</td>
<td>26.059063</td>
<td>-97.208252</td>
<td>Texas</td>
<td>small_community</td>
<td>5.746738</td>
<td>39</td>
<td>0.15</td>
<td>0.239</td>
<td>2621.097459</td>
<td>0.627615</td>
<td>183.96</td>
<td>143488.8</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>3</td>
<td>26.078449</td>
<td>-98.073364</td>
<td>Texas</td>
<td>small_utility</td>
<td>5.742196</td>
<td>39</td>
<td>5.00</td>
<td>0.239</td>
<td>87439.036330</td>
<td>20.920502</td>
<td>6132.00</td>
<td>4782960.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>4</td>
<td>26.143227</td>
<td>-98.311340</td>
<td>Texas</td>
<td>small_utility</td>
<td>5.817187</td>
<td>39</td>
<td>5.00</td>
<td>0.242</td>
<td>85241.850210</td>
<td>20.661157</td>
<td>6132.00</td>
<td>4782960.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<a class="quarto-notebook-link" id="nblink-9" href="1-datasets-preview.html#cell-solar-dataset-preview">Source: Data Preview</a></div>
<p>This dataset is also available to be accessed and downloaded <a href="https://drive.google.com/file/d/1l-USz-TNYyco7rYOaHT3BY_fcnBXI92e/view?usp=sharing">here</a>.</p>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>